<div class="show-consultation">

<%= link_to patient_path(@consultation.patient) do %>
  <div class="card-consult">
    <div class="card-consult-header">
      <%= image_tag "avatar_homme.svg" %>
      <div class="card-info">
        <div class="card-patient-name">
          <%= @consultation.patient.first_name %>  <%= @consultation.patient.last_name %>
        </div>
        <div class="info-adresse">
          <i class="fa-solid fa-location-dot"></i>
          <div class="text-adresse"><%= @consultation.patient.address %></div>
        </div>
      </div>
    </div>
    <div class="card-traitement">
       <% @consultation.treatments.each do |treatment| %>
          <div class="tag-soins <%= treatment.category.downcase %>"> <%= treatment.category %></div>
        <% end %>
    </div>
  </div>
<% end %>

  <% @consultation.treatments.each do |treatment| %>
    <i class="fal fa-ball-pile"></i>
    <div id="checkbox-custom" class="checkbox-container" >
      <div class="checkbox-wrapper">
        <div class="d-flex">
          <% case treatment.category  %>
          <% when "Injection" %>
            <%= image_tag "picto-categories/picto-injection.svg" %>
          <% when "Pansement" %>
            <%= image_tag "picto-categories/picto-pansement.svg" %>
          <% when "Prélèvement" %>
            <%= image_tag "picto-categories/picto-prélèvement.svg" %>
          <% when "Perfusion" %>
            <%= image_tag "picto-categories/picto-perfusion.svg" %>
          <% when "Hygiène" %>
            <%= image_tag "picto-categories/picto-hygiene.svg" %>
          <% when "Aide domicile" %>
            <%= image_tag "picto-categories/picto-domicile.svg" %>
          <% when "Médicament" %>
            <%= image_tag "picto-categories/picto-medicament.svg" %>
          <% when "Diabétique" %>
            <%= image_tag "picto-categories/picto-diabete.svg" %>
          <% when "Autre" %>
            <%= image_tag "picto-categories/picto-nurse.svg" %>
          <% end %>
          <p class="p-3"><%= treatment.content %></p>
        </div>
        <div class="check" data-controller="form">
          <%= simple_form_for treatment, url: treatment_path(treatment), method: :patch, html: { data: { controller: "form" } } do |f| %>
            <%= f.input :done, as: :boolean, label: false, input_html: { data: { action: "change->form#submit" } }%>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <%= link_to "Ajouter un soin", new_consultation_treatment_path(@consultation), class:"btn btn-add-treatment" %>

  <%# notes %>

  <%# TO DO : Afficher toutes les notes créées à la consultation d'avant %>


  <div class="card-note">
    <div class="top-note">
      <h5>Notes :</h5>
      <% @final_notes.each do |note| %>
        <div class="note-content"  data-controller="star">
          <p><%= note.content %></p>
          <%= link_to add_to_favorites_note_path(note), data: { turbo_method: "PATCH"}  do %>
            <% if note.favorite == true %>
              <i data-star-target="starIcon" data-action="click->star#changeStarClass" class="fa-solid fa-star"></i>
            <% else %>
               <i data-star-target="starIcon" data-action="click->star#changeStarClass" class="fa-regular fa-star"></i>
            <% end %>
          <% end %>
        </div>
      <% end %>
      <%= link_to "Ajouter une note", new_consultation_note_path(@consultation), class:"btn btn-add"%>
    </div>
  </div>
  <%= link_to "Fermer la consultation", consultations_path, class:"btn btn-submit" %>
</div>
